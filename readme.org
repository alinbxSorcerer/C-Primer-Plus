#+title: Cover
#+ATTR_HTML: :width 300px
[[file:cprimer-graphics/9780133432381.jpg]]


** Convert to .Org
#+begin_src ipython :session cprimer :results output
import os
import glob
import subprocess
htmls = glob.glob("*.html")
print(htmls)
# htmls.sort(key=lambda x: int(x[2:4]))
for html in htmls:
    cmd = f"pandoc --wrap=none {html} -o {html.replace('html', 'org')}"
    print(cmd)
    subprocess.Popen(cmd, shell=True)
#+end_src

#+RESULTS:
#+begin_example
['ch05.html', 'ch11.html', 'ch15.html', 'cover.html', 'ch08.html', 'ch03.html', 'ch13.html', 'ch09.html', 'ch04.html', 'ch06.html', 'ch07.html', 'bk01-toc.html', 'ch01.html', 'app01.html', 'ch12.html', 'ch02.html', 'ch14.html', 'ch10.html', 'ch17.html', 'ch16.html', 'copyright.html', 'app02.html']
pandoc --wrap=none ch05.html -o ch05.org
pandoc --wrap=none ch11.html -o ch11.org
pandoc --wrap=none ch15.html -o ch15.org
pandoc --wrap=none cover.html -o cover.org
pandoc --wrap=none ch08.html -o ch08.org
pandoc --wrap=none ch03.html -o ch03.org
pandoc --wrap=none ch13.html -o ch13.org
pandoc --wrap=none ch09.html -o ch09.org
pandoc --wrap=none ch04.html -o ch04.org
pandoc --wrap=none ch06.html -o ch06.org
pandoc --wrap=none ch07.html -o ch07.org
pandoc --wrap=none bk01-toc.html -o bk01-toc.org
pandoc --wrap=none ch01.html -o ch01.org
pandoc --wrap=none app01.html -o app01.org
pandoc --wrap=none ch12.html -o ch12.org
pandoc --wrap=none ch02.html -o ch02.org
pandoc --wrap=none ch14.html -o ch14.org
pandoc --wrap=none ch10.html -o ch10.org
pandoc --wrap=none ch17.html -o ch17.org
pandoc --wrap=none ch16.html -o ch16.org
pandoc --wrap=none copyright.html -o copyright.org
pandoc --wrap=none app02.html -o app02.org
#+end_example

#+begin_src ipython :session cprimer :results output
! ls
#+end_src

#+RESULTS:
: 00.readme.org  ch02.html  ch07.html  ch12.html	ch17.html	toc.org
: app01.html     ch03.html  ch08.html  ch13.html	copyright.html
: app02.html     ch04.html  ch09.html  ch14.html	cover.html
: bk01-toc.html  ch05.html  ch10.html  ch15.html	fonts
: ch01.html      ch06.html  ch11.html  ch16.html	graphics

** Clear Up
#+begin_src ipython :session cprimer :results none
import re
import glob


def clearup(filename):
    fp = open(filename, "r+")
    text = fp.read()
    text = re.sub(r"\\", "", text)
    text = re.sub(r"<<.+>>", "", text)
    text = re.sub(r".*:PROPERTIES:.*\n.*:CUSTOM_ID:.*\n.*:END:.*", "",
            text)

    text = re.sub(r"\*(\d\.\d)\*", "\g<1>", text)
    text = re.sub(r"\[\[.*Click here to view code image.*\]",   "", text)
    text = re.sub(r"\*\[\[.*\]\[([0-9]\.[0-9]*)\]\]\*", "\g<1>", text)
    # print(text[:100])
    fp.seek(0)
    fp.write(text)
    fp.close()

clearup("ch01.org")

# orgs = glob.glob("*.org")

#+end_src

#+RESULTS:


#+begin_src ipython :session cprimer :results output
orgs = glob.glob("*.org")
orgs.remove("00.readme.org")
# print(orgs)
for org in orgs:
    clearup(org)

#+end_src

#+RESULTS:
** Rename orgs

#+begin_src ipython :session cprimer :results none
chapters = """
[1 Getting Ready]]

[[file:ch02.html#ch02][2 Introducing C]]

[[file:ch03.html#ch03][3 Data and C]]

[[file:ch04.html#ch04][4 Character Strings and Formatted InputOutput]]

[[file:ch05.html#ch05][5 Operators, Expressions, and Statements]]

[[file:ch06.html#ch06][6 C Control Statements: Looping]]

[[file:ch07.html#ch07][7 C Control Statements: Branching and Jumps]]

[[file:ch08.html#ch08][8 Character Input/Output and Input Validation]]

[[file:ch09.html#ch09][9 Functions]]

[[file:ch10.html#ch10][10 Arrays and Pointers]]

[[file:ch11.html#ch11][11 Character Strings and String Functions]]

[[file:ch12.html#ch12][12 Storage Classes, Linkage, and Memory Management]]

[[file:ch13.html#ch13][13 File Input/Output]]

[[file:ch14.html#ch14][14 Structures and Other Data Forms]]

[[file:ch15.html#ch15][15 Bit Fiddling]]

[[file:ch16.html#ch16][16 The C Preprocessor and the C Library]]

[[file:ch17.html#ch17][17 Advanced Data Representation]]
"""
#+end_src

#+begin_src ipython :session cprimer :results output
# print(chapters)
import re
import os
chs = re.findall(r"\[([0-9]{1,2}[^]]+)\]", chapters)
# print(chs)
orgs = glob.glob("ch*.org")
orgs.sort(key=lambda x: int(x[2:4]))
# print(orgs)
for old, new in zip(orgs, chs):
    os.rename(old, new)

#+end_src

#+RESULTS:
#+begin_example
('ch01.org', '1 Getting Ready')
('ch02.org', '2 Introducing C')
('ch03.org', '3 Data and C')
('ch04.org', '4 Character Strings and Formatted Input/Output')
('ch05.org', '5 Operators, Expressions, and Statements')
('ch06.org', '6 C Control Statements: Looping')
('ch07.org', '7 C Control Statements: Branching and Jumps')
('ch08.org', '8 Character Input/Output and Input Validation')
('ch09.org', '9 Functions')
('ch10.org', '10 Arrays and Pointers')
('ch11.org', '11 Character Strings and String Functions')
('ch12.org', '12 Storage Classes, Linkage, and Memory Management')
('ch13.org', '13 File Input/Output')
('ch14.org', '14 Structures and Other Data Forms')
('ch15.org', '15 Bit Fiddling')
('ch16.org', '16 The C Preprocessor and the C Library')
('ch17.org', '17 Advanced Data Representation')
#+end_example
** Publish
